{% extends 'base.html' %}
{% block title %}ウィークリーミッション管理{% endblock %}
{% block content %}
    <h2>ウィークリーミッション管理</h2>
    <p>ここで設定したミッションは、今週、全生徒のToDoページに表示されます。</p>

    <h3>新しいミッションを追加</h3>
    <form method="POST">
        <label for="description">ミッション内容:</label><br>
        <textarea name="description" id="description" rows="2" style="width: 98%;" required></textarea><br>
        <small>例：「今週は毎日30分以上勉強しよう！」</small>
        
        {# ミッションの目標設定部分は一旦シンプル化のためコメントアウト #}
        {#
        <hr>
        <p><strong>任意：特定の教科の学習時間をミッションにする場合</strong></p>
        <label for="subject_target">教科:</label>
        <select name="subject_target" id="subject_target">
            <option value="none">指定しない</option>
            <option value="国語">国語</option>
            <option value="数学">数学</option>
            <option value="理科">理科</option>
            <option value="社会">社会</option>
            <option value="英語">英語</option>
        </select>
        <label for="minutes_target">目標時間（分）:</label>
        <input type="number" name="minutes_target" id="minutes_target" min="1"><br>
        <small>例：「数学」を「60」分</small>
        #}
        <br><br>
        <input type="submit" value="ミッションを追加">
    </form>

    <hr style="margin: 2em 0;">

    <h3>今週のミッション一覧</h3>
    {% if missions %}
    <table>
        <thead>
            <tr><th>内容</th><th>操作</th></tr>
        </thead>
        <tbody>
            {% for mission in missions %}
            <tr>
                <td>{{ mission.description }}</td>
                <td>
                    <form action="{{ url_for('admin.delete_mission', mission_id=mission.id) }}" method="POST" onsubmit="return confirm('このミッションを削除しますか？');">
                        <button type="submit" style="background:none; border:none; color:#dc3545; padding:0; font-size:1em; cursor:pointer;">削除</button>
                    </form>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% else %}
    <p>今週のミッションはまだ設定されていません。</p>
    {% endif %}
{% endblock %}