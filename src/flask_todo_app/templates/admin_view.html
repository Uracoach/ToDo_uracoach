{% extends 'base.html' %}
{% block title %}ç®¡ç†ãƒ“ãƒ¥ãƒ¼: {{ student.name }}{% endblock %}
{% block content %}
    <h2>{{ student.name }}ã®ToDoé–²è¦§ï¼ˆ{{ date }})</h2>
    <a href="{{ url_for('main.student_chart', student_name=student.name) }}" target="_blank">ğŸ“Š {{ student.name }}ã®å­¦ç¿’ã‚°ãƒ©ãƒ•ã‚’è¦‹ã‚‹</a>
    
    <hr style="margin: 2em 0;">
    
    <h3>ä»Šé€±ã®ãƒŸãƒƒã‚·ãƒ§ãƒ³é”æˆçŠ¶æ³</h3>
    <table>
        <thead>
            <tr><th>ãƒŸãƒƒã‚·ãƒ§ãƒ³å†…å®¹</th><th>çŠ¶æ…‹</th><th>æ“ä½œ</th></tr>
        </thead>
        <tbody>
            {% for mission in missions %}
            <tr>
                <td>{{ mission.description }}</td>
                <td>
                    {% if mission.id in completed_mission_ids %}
                        <span style="color: green; font-weight: bold;">âœ” é”æˆæ¸ˆã¿</span>
                    {% else %}
                        <span style="color: #888;">æœªé”æˆ</span>
                    {% endif %}
                </td>
                <td>
                    {% if not mission.id in completed_mission_ids %}
                    <form action="{{ url_for('admin.mark_mission_complete', mission_id=mission.id) }}" method="POST">
                        <input type="submit" value="å®Œäº†ã«ã™ã‚‹" style="width: auto; padding: 5px 10px;">
                    </form>
                    {% endif %}
                </td>
            </tr>
            {% else %}
            <tr><td colspan="3">ä»Šé€±ã®ãƒŸãƒƒã‚·ãƒ§ãƒ³ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</td></tr>
            {% endfor %}
        </tbody>
    </table>

    <hr style="margin: 2em 0;">

    <h3>ToDoãƒªã‚¹ãƒˆ</h3>
    <form method="GET">
        <input type="date" name="date" value="{{ date }}">
        <input type="submit" value="æ—¥ä»˜ã§è¡¨ç¤º" style="width: auto; padding: 5px 10px;">
    </form>
    <table>
        <thead>
            <tr><th>å®Œäº†</th><th>æ•™ç§‘</th><th>æ•™æ</th><th>ãƒšãƒ¼ã‚¸</th><th>ç›®æ¨™</th><th>å®Ÿç¸¾</th><th>ä¼‘æ†©</th></tr>
        </thead>
        <tbody>
        {% for todo in todos %}
        <tr>
            <td>{{ 'âœ”' if todo.completed else ' ' }}</td>
            <td>{{ todo.subject }}</td>
            <td>{{ todo.material }}</td>
            <td>{{ todo.start_page }} - {{ todo.end_page }}</td>
            <td>{{ todo.target_hour }}h {{ todo.target_min }}m</td>
            <td>{{ todo.actual_hour }}h {{ todo.actual_min }}m</td>
            <td>{{ (todo.break_seconds or 0) // 60 }}åˆ† {{ (todo.break_seconds or 0) % 60 }}ç§’</td>
        </tr>
        {% else %}
        <tr><td colspan="7">ã“ã®æ—¥ã®ToDoã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</td></tr>
        {% endfor %}
        </tbody>
    </table>
{% endblock %}